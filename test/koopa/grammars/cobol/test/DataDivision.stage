package koopa.grammars.cobol.test;
grammar koopa.grammars.cobol.CobolGrammar;

target redefines;

+[ REDEFINES TEST-1 ]


target blankWhenZero;

+[ BLANK WHEN ZERO ]
+[ BLANK WHEN ZEROS ]
+[ BLANK WHEN ZEROES ]

+[ BLANK ZERO ]
+[ BLANK ZEROS ]
+[ BLANK ZEROES ]


target external;

+[ IS EXTERNAL ]
+[ EXTERNAL ]


target global;

+[ IS GLOBAL ]
+[ GLOBAL ]


target justified;

+[ JUSTIFIED RIGHT ]
+[ JUST RIGHT ]


target occurs;

+[ OCCURS 42 TIMES ]
+[ OCCURS 42 ]

-[ OCCURS 42.0 TIMES ]
-[ OCCURS 42.0 ]

+[ OCCURS 42 TIMES 
   ASCENDING KEY IS MY-KEY ]
+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-KEY ]

+[ OCCURS 42 TIMES 
   ASCENDING MY-KEY ]
+[ OCCURS 42 TIMES 
   DESCENDING MY-KEY ]

+[ OCCURS 42 TIMES 
   ASCENDING MY-KEY MY-OTHER-KEY ]
+[ OCCURS 42 TIMES 
   DESCENDING MY-KEY MY-OTHER-KEY ]

+[ OCCURS 42 TIMES 
   ASCENDING KEY IS MY-KEY MY-OTHER-KEY ]
+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-KEY MY-OTHER-KEY ]

+[ OCCURS 42 TIMES 
   ASCENDING KEY IS MY-ASC-KEY MY-OTHER-ASC-KEY 
   DESCENDING KEY IS MY-DESC-KEY MY-OTHER-DESC-KEY ]

+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-DESC-KEY MY-OTHER-DESC-KEY
   ASCENDING KEY IS MY-ASC-KEY MY-OTHER-ASC-KEY ]

+[ OCCURS 42 TIMES
   INDEXED BY MY-INDEX ]

+[ OCCURS 42 TIMES
   INDEXED BY MY-INDEX MY-OTHER-INDEX ]

+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-DESC-KEY MY-OTHER-DESC-KEY
   ASCENDING MY-ASC-KEY MY-OTHER-ASC-KEY
   INDEXED BY MY-INDEX MY-OTHER-INDEX ]

+[ OCCURS 7 TO 42 TIMES ]
+[ OCCURS 7 # TO 42.0 TIMES ]
-[ OCCURS 7.0 TO 42 TIMES ]
-[ OCCURS 7.0 TO 42.0 TIMES ]

+[ OCCURS 7 TO 42 TIMES DEPENDING ON MY-FIELD ]

+[ OCCURS 7 TO 42 TIMES DEPENDING ON MY-FIELD OF MY-RECORD IN MY-OTHER-RECORD ]

+[ OCCURS 42 TIMES DEPENDING ON MY-FIELD ]

+[ OCCURS 7 TO 42 TIMES DEPENDING ON MY-FIELD
   DESCENDING KEY IS MY-DESC-KEY MY-OTHER-DESC-KEY
   ASCENDING MY-ASC-KEY MY-OTHER-ASC-KEY
   INDEXED BY MY-INDEX MY-OTHER-INDEX ]


# Requested by MasterProgrammer, and corroborated by the IBM Enterprise Cobol reference:
# The data-name in the key clause can be qualified.
+[ OCCURS 42 TIMES 
   ASCENDING KEY IS MY-KEY OF MY-TABLE ]
+[ OCCURS 42 TIMES 
   ASCENDING KEY IS MY-KEY IN MY-TABLE ]
+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-KEY OF MY-TABLE ]
+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-KEY IN MY-TABLE ]



target sign;

+[ LEADING ]
+[ TRAILING ]

+[ LEADING SEPARATE ]
+[ TRAILING SEPARATE ]
+[ LEADING SEPARATE CHARACTER ]
+[ TRAILING SEPARATE CHARACTER ]

+[ SIGN LEADING ]
+[ SIGN TRAILING ]
+[ SIGN IS LEADING ]
+[ SIGN IS TRAILING ]

+[ SIGN LEADING SEPARATE ]
+[ SIGN TRAILING SEPARATE ]
+[ SIGN IS LEADING SEPARATE ]
+[ SIGN IS TRAILING SEPARATE ]

+[ SIGN LEADING SEPARATE CHARACTER ]
+[ SIGN TRAILING SEPARATE CHARACTER ]
+[ SIGN IS LEADING SEPARATE CHARACTER ]
+[ SIGN IS TRAILING SEPARATE CHARACTER ]


target sync;

+[ SYNCHRONIZED ]
+[ SYNC ]

+[ SYNCHRONIZED LEFT ]
+[ SYNC LEFT ]

+[ SYNCHRONIZED RIGHT ]
+[ SYNC RIGHT ]


target usage;

+[ BINARY ] 
+[ USAGE BINARY ] 
+[ USAGE IS BINARY ] 

+[ COMPUTATIONAL ] 
+[ USAGE COMPUTATIONAL ] 
+[ USAGE IS COMPUTATIONAL ] 

+[ COMP ] 
+[ USAGE COMP ] 
+[ USAGE IS COMP ] 

+[ DISPLAY ] 
+[ USAGE DISPLAY ] 
+[ USAGE IS DISPLAY ] 

+[ INDEX ] 
+[ USAGE INDEX ] 
+[ USAGE IS INDEX ] 

+[ PACKED-DECIMAL ] 
+[ USAGE PACKED-DECIMAL ] 
+[ USAGE IS PACKED-DECIMAL ] 

+[ COMPUTATIONAL-1 ] 
+[ USAGE COMPUTATIONAL-1 ] 
+[ USAGE IS COMPUTATIONAL-1 ] 

+[ COMP-1 ] 
+[ USAGE COMP-1 ] 
+[ USAGE IS COMP-1 ] 

+[ COMPUTATIONAL-2 ] 
+[ USAGE COMPUTATIONAL-2 ] 
+[ USAGE IS COMPUTATIONAL-2 ] 

+[ COMP-2 ] 
+[ USAGE COMP-2 ] 
+[ USAGE IS COMP-2 ] 

+[ COMPUTATIONAL-3 ] 
+[ USAGE COMPUTATIONAL-3 ] 
+[ USAGE IS COMPUTATIONAL-3 ] 

+[ COMP-3 ] 
+[ USAGE COMP-3 ] 
+[ USAGE IS COMP-3 ] 

+[ COMPUTATIONAL-5 ] 
+[ USAGE COMPUTATIONAL-5 ] 
+[ USAGE IS COMPUTATIONAL-5 ] 

+[ COMP-5 ] 
+[ USAGE COMP-5 ] 
+[ USAGE IS COMP-5 ]

+[ POINTER ] 
+[ USAGE POINTER ] 
+[ USAGE IS POINTER ]

+[ BINARY-LONG ] 
+[ USAGE BINARY-LONG ] 
+[ USAGE IS BINARY-LONG ]


target valueIs;

+[ VALUE IS ZERO ]

+[ VALUE ZERO ]

+[ VALUE IS 42 ]

+[ VALUE 42 ]

+[ VALUE IS 42.10 ]

+[ VALUE 42.10 ]

+[ VALUE IS "this is a constant" ]

+[ VALUE "this is a constant" ]

+[ VALUE IS NULL ]

+[ VALUE NULL ]

+[ VALUE IS 'this is a constant' ]

+[ VALUE 'this is a constant' ]


target whenSetToFalseClause;

+[ WHEN SET TO FALSE IS 'A' ]
+[ WHEN SET TO FALSE 'A' ]
+[ FALSE IS 'A' ]
+[ FALSE 'A' ]


target dataDescriptionEntry;

+[ 01 FILLER . ]

+[ 01 TEST-2 . ]

+[ 01 . ]

+[ 1 TEST-3 . ]

+[ 11 TEST-4 . ]

+[ 49 TEST-5 . ]

+[ 77 TEST-6 . ]

-[ 0 TEST-7 . ]

-[ 50 TEST-8 . ]

-[ AA TEST-9 . ]

+[ 66 TEST-10
      RENAMES TEST-1 . ]

+[ 66 TEST-11
      RENAMES TEST-2 THROUGH TEST-3 . ]

+[ 66 TEST-12
      RENAMES TEST-4 THRU TEST-5 . ]

+[ 66 TEST-10B
      RENAMES TEST-1 OF TESTSUITE . ]

+[ 66 TEST-11B
      RENAMES TEST-2 OF TESTSUITE THROUGH TEST-3 OF TESTSUITE . ]

+[ 66 TEST-12B
      RENAMES TEST-4 OF TESTSUITE THRU TEST-5 OF TESTSUITE . ]

+[ 88 TEST-13
      VALUE IS "AAA" . ]

+[ 88 TEST-14
      VALUE "BBB" . ]

+[ 88 TEST-15
      VALUES ARE "CCC" . ]

+[ 88 TEST-16
      VALUES "DDD" . ]

+[ 88 TEST-17
      VALUES ARE 0 THROUGH 10 . ]

+[ 88 TEST-18
      VALUES ARE 0 THROUGH 10
                 20 THROUGH 30 . ]

+[ 88 TEST-19
      VALUES ARE 0 THROUGH 10
                 20 THROUGH 30
                 66 . ]

+[ 88 TEST-20
      VALUES ARE 0 THROUGH 10
                 15
                 20 THROUGH 30 . ]

+[ 88 TEST-21
      VALUE IS ZERO . ]

+[ 88 TEST-22
      VALUE IS 'B'
      WHEN SET TO FALSE IS 'A' . ]

+[ 88 TEST-23
      VALUE IS 'B'
      WHEN SET TO FALSE 'A' . ]

+[ 88 TEST-24
      VALUE IS 'B'
      FALSE IS 'A' . ]

+[ 88 TEST-25
      VALUE IS 'B'
      FALSE 'A' . ]


+[ 05 BUFFER
      POINTER
      VALUE NULL . ]

+{
004400 77  WS-TEST-12-DATA                                              NC2054.2
004500                        PIC S9(                                   NC2054.2
004600-                              6)V9(6).                           NC2054.2
}

+{
003800     03 GUBBINS PIC X(1                                           NC4014.2
003900-                      00).                                       NC4014.2
}

+[ 77 OPTIONS PIC S9(9) BINARY . ]

# Examples of level 78 from Simon Sobisch.
+[ 78 lines-to-display . ]
+[ 78 lines-to-display value is 12 . ]
+[ 78 lines-to-display value 12 . ]

# Example from http://opencobol.add1tocobol.com/#based.
+[ 01 based-var PIC X(80) BASED . ]

target workingStorageSection;

+[ WORKING-STORAGE Section .
   COPY "WORKSTOR.WS" .
]
