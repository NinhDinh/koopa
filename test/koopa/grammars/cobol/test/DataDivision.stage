package koopa.grammars.cobol.test;
grammar koopa.grammars.cobol.CobolGrammar;

target dataDivision;

+[ DATA DIVISION .
   WORKING-STORAGE Section .
   COPY "WORKSTOR.WS" .
]

+[ WORKING-STORAGE Section .
   COPY "WORKSTOR.WS" .
]

target redefines;

+[ REDEFINES TEST-1 ]


target blankWhenZero;

+[ BLANK WHEN ZERO ]
+[ BLANK WHEN ZEROS ]
+[ BLANK WHEN ZEROES ]

+[ BLANK ZERO ]
+[ BLANK ZEROS ]
+[ BLANK ZEROES ]


target space;

+[ SPACE ]
+[ SPACES ]

target external;

+[ EXTERNAL ]
+[ IS EXTERNAL ]
+[ IS EXTERNAL AS "foo" ]
+[ IS EXTERNAL BY "foo" ]
-[ EXTERNAL "foo" ]

target propertyClause;

+[ PROPERTY ]
+[ PROPERTY NO GET ]
+[ PROPERTY NO SET ]
+[ PROPERTY WITH NO GET ]
+[ PROPERTY WITH NO SET ]
-[ PROPERTY GET ]
-[ PROPERTY SET ]
-[ PROPERTY WITH GET ]
-[ PROPERTY WITH SET ]

target global;

+[ IS GLOBAL ]
+[ GLOBAL ]

target typedefClause;

+[ IS TYPEDEF ]
+[ TYPEDEF ]

target threadLocalClause;

+[ IS THREAD-LOCAL ]
+[ THREAD-LOCAL ]

target justified;

+[ JUSTIFIED RIGHT ]
+[ JUST RIGHT ]

target occurs;

+[ OCCURS 42 TIMES ]
+[ OCCURS 42 ]

-[ OCCURS 42.0 TIMES ]
-[ OCCURS 42.0 ]

+[ OCCURS 42 TIMES 
   ASCENDING KEY IS MY-KEY ]
+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-KEY ]

+[ OCCURS 42 TIMES 
   ASCENDING MY-KEY ]
+[ OCCURS 42 TIMES 
   DESCENDING MY-KEY ]

+[ OCCURS 42 TIMES 
   ASCENDING MY-KEY MY-OTHER-KEY ]
+[ OCCURS 42 TIMES 
   DESCENDING MY-KEY MY-OTHER-KEY ]

+[ OCCURS 42 TIMES 
   ASCENDING KEY IS MY-KEY MY-OTHER-KEY ]
+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-KEY MY-OTHER-KEY ]

+[ OCCURS 42 TIMES 
   ASCENDING KEY IS MY-ASC-KEY MY-OTHER-ASC-KEY 
   DESCENDING KEY IS MY-DESC-KEY MY-OTHER-DESC-KEY ]

+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-DESC-KEY MY-OTHER-DESC-KEY
   ASCENDING KEY IS MY-ASC-KEY MY-OTHER-ASC-KEY ]

+[ OCCURS 42 TIMES
   INDEXED BY MY-INDEX ]

+[ OCCURS 42 TIMES
   INDEXED BY MY-INDEX MY-OTHER-INDEX ]

+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-DESC-KEY MY-OTHER-DESC-KEY
   ASCENDING MY-ASC-KEY MY-OTHER-ASC-KEY
   INDEXED BY MY-INDEX MY-OTHER-INDEX ]

+[ OCCURS 7 TO 42 TIMES ]
-[ OCCURS 7 TO 42.0 TIMES ]
-[ OCCURS 7.0 TO 42 TIMES ]
-[ OCCURS 7.0 TO 42.0 TIMES ]

+[ OCCURS 7 TO 42 TIMES DEPENDING ON MY-FIELD ]

+[ OCCURS 7 TO 42 TIMES DEPENDING ON MY-FIELD OF MY-RECORD IN MY-OTHER-RECORD ]

+[ OCCURS 42 TIMES DEPENDING ON MY-FIELD ]

+[ OCCURS 7 TO 42 TIMES DEPENDING ON MY-FIELD
   DESCENDING KEY IS MY-DESC-KEY MY-OTHER-DESC-KEY
   ASCENDING MY-ASC-KEY MY-OTHER-ASC-KEY
   INDEXED BY MY-INDEX MY-OTHER-INDEX ]


# Requested by MasterProgrammer, and corroborated by the IBM Enterprise Cobol reference:
# The data-name in the key clause can be qualified.
+[ OCCURS 42 TIMES 
   ASCENDING KEY IS MY-KEY OF MY-TABLE ]
+[ OCCURS 42 TIMES 
   ASCENDING KEY IS MY-KEY IN MY-TABLE ]
+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-KEY OF MY-TABLE ]
+[ OCCURS 42 TIMES 
   DESCENDING KEY IS MY-KEY IN MY-TABLE ]

# Issue #28; adding extra checks for places where functions, object refs and
# reference mods are not allowed.
-[ OCCURS 42 TIMES DEPENDING ON FUNCTION FN ( X ) ]
-[ OCCURS 42 TIMES DEPENDING ON EXCEPTION-OBJECT ]
-[ OCCURS 42 TIMES DEPENDING ON NULL ]
-[ OCCURS 42 TIMES DEPENDING ON SELF ]
-[ OCCURS 42 TIMES DEPENDING ON SUPER ]
-[ OCCURS 42 TIMES DEPENDING ON MY-CLASS-NAME OF SUPER ]
-[ OCCURS 42 TIMES DEPENDING ON ADDRESS OF SOMETHING ]

-[ OCCURS 42 TIMES ASCENDING KEY IS FUNCTION FN ( X ) ]
-[ OCCURS 42 TIMES ASCENDING KEY IS EXCEPTION-OBJECT ]
-[ OCCURS 42 TIMES ASCENDING KEY IS NULL ]
-[ OCCURS 42 TIMES ASCENDING KEY IS SELF ]
-[ OCCURS 42 TIMES ASCENDING KEY IS SUPER ]
-[ OCCURS 42 TIMES ASCENDING KEY IS MY-CLASS-NAME OF SUPER ]
-[ OCCURS 42 TIMES ASCENDING KEY IS ADDRESS OF SOMETHING ]




target sign;

+[ LEADING ]
+[ TRAILING ]

+[ LEADING SEPARATE ]
+[ TRAILING SEPARATE ]
+[ LEADING SEPARATE CHARACTER ]
+[ TRAILING SEPARATE CHARACTER ]

+[ SIGN LEADING ]
+[ SIGN TRAILING ]
+[ SIGN IS LEADING ]
+[ SIGN IS TRAILING ]

+[ SIGN LEADING SEPARATE ]
+[ SIGN TRAILING SEPARATE ]
+[ SIGN IS LEADING SEPARATE ]
+[ SIGN IS TRAILING SEPARATE ]

+[ SIGN LEADING SEPARATE CHARACTER ]
+[ SIGN TRAILING SEPARATE CHARACTER ]
+[ SIGN IS LEADING SEPARATE CHARACTER ]
+[ SIGN IS TRAILING SEPARATE CHARACTER ]


target sync;

+[ SYNCHRONIZED ]
+[ SYNC ]

+[ SYNCHRONIZED LEFT ]
+[ SYNC LEFT ]

+[ SYNCHRONIZED RIGHT ]
+[ SYNC RIGHT ]


target usage;

+[ BINARY ] 
+[ USAGE BINARY ] 
+[ USAGE IS BINARY ]

+[ BINARY-CHAR ] 
+[ USAGE BINARY-CHAR ] 
+[ USAGE IS BINARY-CHAR ]
+[ BINARY-CHAR SIGNED ]
+[ USAGE BINARY-CHAR SIGNED ]
+[ USAGE IS BINARY-CHAR SIGNED ] 
+[ BINARY-CHAR UNSIGNED ]
+[ USAGE BINARY-CHAR UNSIGNED ]
+[ USAGE IS BINARY-CHAR UNSIGNED ]

+[ BINARY-LONG ] 
+[ USAGE BINARY-LONG ] 
+[ USAGE IS BINARY-LONG ]
+[ BINARY-LONG SIGNED ]
+[ USAGE BINARY-LONG SIGNED ]
+[ USAGE IS BINARY-LONG SIGNED ] 
+[ BINARY-LONG UNSIGNED ]
+[ USAGE BINARY-LONG UNSIGNED ]
+[ USAGE IS BINARY-LONG UNSIGNED ]

+[ BINARY-SHORT ] 
+[ USAGE BINARY-SHORT ] 
+[ USAGE IS BINARY-SHORT ]
+[ BINARY-SHORT SIGNED ]
+[ USAGE BINARY-SHORT SIGNED ]
+[ USAGE IS BINARY-SHORT SIGNED ] 
+[ BINARY-SHORT UNSIGNED ]
+[ USAGE BINARY-SHORT UNSIGNED ]
+[ USAGE IS BINARY-SHORT UNSIGNED ]

+[ BINARY-DOUBLE ] 
+[ USAGE BINARY-DOUBLE ] 
+[ USAGE IS BINARY-DOUBLE ]
+[ BINARY-DOUBLE SIGNED ]
+[ USAGE BINARY-DOUBLE SIGNED ]
+[ USAGE IS BINARY-DOUBLE SIGNED ] 
+[ BINARY-DOUBLE UNSIGNED ]
+[ USAGE BINARY-DOUBLE UNSIGNED ]
+[ USAGE IS BINARY-DOUBLE UNSIGNED ]

+[ BINARY-C-LONG ] 
+[ USAGE BINARY-C-LONG ] 
+[ USAGE IS BINARY-C-LONG ]

+ [ FLOAT-SHORT ]
+ [ USAGE FLOAT-SHORT ]
+ [ USAGE IS FLOAT-SHORT ]

+ [ FLOAT-LONG ]
+ [ USAGE FLOAT-LONG ]
+ [ USAGE IS FLOAT-LONG ]

+ [ FLOAT-EXTENDED ]
+ [ USAGE FLOAT-EXTENDED ]
+ [ USAGE IS FLOAT-EXTENDED ]

+ [ BIT ]
+ [ USAGE BIT ]
+ [ USAGE IS BIT ]

+ [ CHARACTER ]
+ [ USAGE CHARACTER ]
+ [ USAGE IS CHARACTER ]

+[ COMPUTATIONAL ] 
+[ USAGE COMPUTATIONAL ] 
+[ USAGE IS COMPUTATIONAL ] 

+[ COMP ] 
+[ USAGE COMP ] 
+[ USAGE IS COMP ] 

+ [ DECIMAL ]
+ [ USAGE DECIMAL ]
+ [ USAGE IS DECIMAL ]

+[ DISPLAY ] 
+[ USAGE DISPLAY ] 
+[ USAGE IS DISPLAY ] 

+[ INDEX ] 
+[ USAGE INDEX ] 
+[ USAGE IS INDEX ] 

+[ PACKED-DECIMAL ] 
+[ USAGE PACKED-DECIMAL ] 
+[ USAGE IS PACKED-DECIMAL ] 

+[ COMPUTATIONAL-1 ] 
+[ USAGE COMPUTATIONAL-1 ] 
+[ USAGE IS COMPUTATIONAL-1 ] 

+[ COMP-1 ] 
+[ USAGE COMP-1 ] 
+[ USAGE IS COMP-1 ] 

+[ COMPUTATIONAL-2 ] 
+[ USAGE COMPUTATIONAL-2 ] 
+[ USAGE IS COMPUTATIONAL-2 ] 

+[ COMP-2 ] 
+[ USAGE COMP-2 ] 
+[ USAGE IS COMP-2 ] 

+[ COMPUTATIONAL-3 ] 
+[ USAGE COMPUTATIONAL-3 ] 
+[ USAGE IS COMPUTATIONAL-3 ] 

+[ COMP-3 ] 
+[ USAGE COMP-3 ] 
+[ USAGE IS COMP-3 ] 

+[ COMPUTATIONAL-5 ] 
+[ USAGE COMPUTATIONAL-5 ] 
+[ USAGE IS COMPUTATIONAL-5 ] 

+[ COMP-5 ] 
+[ USAGE COMP-5 ] 
+[ USAGE IS COMP-5 ]

+[ COMPUTATIONAL-X ] 
+[ USAGE COMPUTATIONAL-X ] 
+[ USAGE IS COMPUTATIONAL-X ]

+[ COMP-X ] 
+[ USAGE COMP-X ] 
+[ USAGE IS COMP-X ]

+[ POINTER ] 
+[ USAGE POINTER ] 
+[ USAGE IS POINTER ]

+ [ MONITOR-POINTER ]
+ [ USAGE MONITOR-POINTER ]
+ [ USAGE IS MONITOR-POINTER ]

+ [ MUTEX-POINTER ]
+ [ USAGE MUTEX-POINTER ]
+ [ USAGE IS MUTEX-POINTER ]

+ [ NATIONAL ]
+ [ USAGE NATIONAL ]
+ [ USAGE IS NATIONAL ]

+ [          OBJECT REFERENCE ]
+ [ USAGE    OBJECT REFERENCE ]
+ [ USAGE IS OBJECT REFERENCE ]
+ [          OBJECT REFERENCE            ACTIVE-CLASS ]
+ [ USAGE    OBJECT REFERENCE            ACTIVE-CLASS ]
+ [ USAGE IS OBJECT REFERENCE            ACTIVE-CLASS ]
+ [          OBJECT REFERENCE FACTORY OF ACTIVE-CLASS ]
+ [ USAGE    OBJECT REFERENCE FACTORY OF ACTIVE-CLASS ]
+ [ USAGE IS OBJECT REFERENCE FACTORY OF ACTIVE-CLASS ]
+ [          OBJECT REFERENCE            foo ONLY ]
+ [ USAGE    OBJECT REFERENCE            foo ONLY ]
+ [ USAGE IS OBJECT REFERENCE            foo ONLY ]
+ [          OBJECT REFERENCE FACTORY OF foo ONLY ]
+ [ USAGE    OBJECT REFERENCE FACTORY OF foo ONLY ]
+ [ USAGE IS OBJECT REFERENCE FACTORY OF foo ONLY ]
+ [          OBJECT REFERENCE            foo EVENT ]
+ [ USAGE    OBJECT REFERENCE            foo EVENT ]
+ [ USAGE IS OBJECT REFERENCE            foo EVENT ]
+ [          OBJECT REFERENCE FACTORY OF foo EVENT ]
+ [ USAGE    OBJECT REFERENCE FACTORY OF foo EVENT ]
+ [ USAGE IS OBJECT REFERENCE FACTORY OF foo EVENT ]


target valueClause;

+[ VALUE IS ZERO ]

+[ VALUE ZERO ]

+[ VALUE IS 42 ]

+[ VALUE 42 ]

+[ VALUE IS 42.10 ]

+[ VALUE 42.10 ]

+[ VALUE IS "this is a constant" ]

+[ VALUE "this is a constant" ]

+[ VALUE IS NULL ]

+[ VALUE NULL ]

+[ VALUE IS 'this is a constant' ]

+[ VALUE 'this is a constant' ]

+[ VALUE IS SOME-CONSTANT ]

+[ VALUE SOME-CONSTANT ]


target whenSetToFalseClause;

+[ WHEN SET TO FALSE IS 'A' ]
+[ WHEN SET TO FALSE 'A' ]
+[ FALSE IS 'A' ]
+[ FALSE 'A' ]


target dataDescriptionEntry;

+[ 17 FILLER . ]

+[ 17 TEST-2 . ]

+[ 01 . ]

+[ 1 TEST-3 . ]

+[ 11 TEST-4 . ]

+[ 49 TEST-5 . ]

+[ 77 TEST-6 . ]

-[ 0 TEST-7 . ]

-[ 50 TEST-8 . ]

-[ AA TEST-9 . ]

+[ 66 TEST-10
      RENAMES TEST-1 . ]

+[ 66 TEST-11
      RENAMES TEST-2 THROUGH TEST-3 . ]

+[ 66 TEST-12
      RENAMES TEST-4 THRU TEST-5 . ]

+[ 66 TEST-10B
      RENAMES TEST-1 OF TESTSUITE . ]

+[ 66 TEST-11B
      RENAMES TEST-2 OF TESTSUITE THROUGH TEST-3 OF TESTSUITE . ]

+[ 66 TEST-12B
      RENAMES TEST-4 OF TESTSUITE THRU TEST-5 OF TESTSUITE . ]

+[ 88 TEST-13A
    VALUE -1 . ]

+[ 88 TEST-13B
      VALUE IS "AAA" . ]

+[ 88 TEST-14
      VALUE "BBB" . ]

+[ 88 TEST-15
      VALUES ARE "CCC" . ]

+[ 88 TEST-16
      VALUES "DDD" . ]

+[ 88 TEST-17
      VALUES ARE 0 THROUGH 10 . ]

+[ 88 TEST-18
      VALUES ARE 0 THROUGH 10
                 20 THROUGH 30 . ]

+[ 88 TEST-19
      VALUES ARE 0 THROUGH 10
                 20 THROUGH 30
                 66 . ]

+[ 88 TEST-20
      VALUES ARE 0 THROUGH 10
                 15
                 20 THROUGH 30 . ]

+[ 88 TEST-21
      VALUE IS ZERO . ]

+[ 88 TEST-22
      VALUE IS 'B'
      WHEN SET TO FALSE IS 'A' . ]

+[ 88 TEST-23
      VALUE IS 'B'
      WHEN SET TO FALSE 'A' . ]

+[ 88 TEST-24
      VALUE IS 'B'
      FALSE IS 'A' . ]

+[ 88 TEST-25
      VALUE IS 'B'
      FALSE 'A' . ]


+[ 05 BUFFER
      POINTER
      VALUE NULL . ]

+[ 05 foo ANY LENGTH . ]
+[ 05 foo ANY LENGTH . ]
+[ 05 foo ANY LENGTH
   BLANK WHEN ZERO . ]

+[ 05 foo IS EXTERNAL AS "bar" . ]

+[ 05 foo PUBLIC . ]
+[ 05 foo INTERNAL . ]
+[ 05 foo PRIVATE . ]
+[ 05 foo PROTECTED . ]
+[ 05 foo ATTRIBUTE bar ( n ) . ]
+[ 05 foo PUBLIC
   ATTRIBUTE bar ( NAME n = v ) . ]
+[ 05 foo PRIVATE
   CUSTOM-ATTRIBUTE bar . ]
+[ 05 foo PROTECTED
   CUSTOM-ATTRIBUTE bar ( n = v ) . ]

+[ 05 foo IS TYPEDEF . ]
+[ 05 foo IS THREAD-LOCAL . ]

+[ 05 foo PROPERTY . ]
+[ 05 foo PROPERTY WITH NO SET . ]

+{
004400 77  WS-TEST-12-DATA                                              NC2054.2
004500                        PIC S9(                                   NC2054.2
004600-                              6)V9(6).                           NC2054.2
}

+{
003800     03 GUBBINS PIC X(1                                           NC4014.2
003900-                      00).                                       NC4014.2
}

+[ 77 OPTIONS PIC S9(9) BINARY . ]


# Examples of level 78 from Simon Sobisch.
-[ 78 lines-to-display . ]              # VALUE is required
+[ 78 lines-to-display value is 12 . ]
+[ 78 lines-to-display value 12 . ]

+[ 78 foo VALUE NEXT . ]
+[ 78 foo VALUE NEXT + 1 . ]

+[ 78 foo VALUE START bar . ]
+[ 78 foo VALUE START OF bar . ]
+[ 78 foobar VALUE START OF foo + LENGTH OF bar . ]

+[ 78 foo VALUE LENGTH bar . ]
+[ 78 foo VALUE LENGTH OF bar . ]
+[ 78 foobar VALUE "foo" & bar . ]

+[ 78 foo VALUE 4 * 2 . ]
+[ 78 foo VALUE bar ** 2 . ]
+[ 78 foo VALUE 4 * bar . ]

# Example from http://opencobol.add1tocobol.com/#based.
+[ 01 based-var PIC X(80) BASED . ]


# Issue #28; adding extra checks for places where functions, object refs and
# reference mods are not allowed.
-[ 66 FAULTY
      RENAMES FUNCTION FN ( X ) . ]
-[ 66 FAULTY
      RENAMES FOO
      THROUGH FUNCTION FN ( X ) . ]

-[ 66 FAULTY
      RENAMES EXCEPTION-OBJECT . ]
-[ 66 FAULTY
      RENAMES FOO
      THROUGH EXCEPTION-OBJECT . ]

-[ 66 FAULTY
      RENAMES NULL . ]
-[ 66 FAULTY
      RENAMES FOO
      THROUGH NULL . ]

-[ 66 FAULTY
      RENAMES SELF . ]
-[ 66 FAULTY
      RENAMES FOO
      THROUGH SELF . ]

-[ 66 FAULTY
      RENAMES SUPER . ]
-[ 66 FAULTY
      RENAMES FOO
      THROUGH SUPER . ]

-[ 66 FAULTY
      RENAMES MY-CLASS-NAME OF SUPER . ]
-[ 66 FAULTY
      RENAMES FOO
      THROUGH MY-CLASS-NAME OF SUPER . ]

-[ 66 FAULTY
      RENAMES ADDRESS OF SOMETHING . ]
-[ 66 FAULTY
      RENAMES FOO
      THROUGH ADDRESS OF SOMETHING . ]

target localStorageSection;

+[ LOCAL-STORAGE Section .
   COPY "LOCLSTOR.LS" . ]

+[ LOCAL-STORAGE SECTION .
   77 OPTIONS PIC S9(9) BINARY . ]

target workingStorageSection;

+[ WORKING-STORAGE Section .
   COPY "WORKSTOR.WS" .
]

target threadLocalStorageSection;

+[ THREAD-LOCAL-STORAGE Section .
   COPY "THRDSTOR.LS" . ]

+[ THREAD-LOCAL-STORAGE SECTION .
   77 OPTIONS PIC S9(9) BINARY . ]

target objectStorageSection;

+[ OBJECT-STORAGE Section .
   COPY "OBJSTOR.OS" . ]

+[ OBJECT-STORAGE SECTION .
   77 OPTIONS PIC S9(9) BINARY . ]